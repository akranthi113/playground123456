<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vedic Astrology South Indian Chart</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease; /* Added border-color */
        }

        body {
            background-color: #000; /* Pure Black Background */
            margin: 0;
            padding: 20px;
            color: #fff; /* White Text */
        }

        .chart-title {
            text-align: center;
            font-size: 1.7em;
            font-weight: bold;
            margin-bottom: 20px;
            color: #fff; /* White title */
        }

        .chart-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-auto-rows: minmax(85px, auto);
            gap: 1px;
            width: 360px;
            margin: auto;
            border: 1px solid #555; /* Darker border */
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.6); /* Darker shadow */
        }

        .chart-box {
            border: 1px solid #333; /* Even darker inner borders */
            position: relative;
            background-color: #1a1a1a; /* Very dark gray box background */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            text-align: center;
            padding: 3px;
            overflow-y: auto;
        }

        /* Scrollbar styles for chart boxes */
        .chart-box::-webkit-scrollbar {
            width: 6px;
        }
        .chart-box::-webkit-scrollbar-track {
            background: #222;
            border-radius: 10px;
        }
        .chart-box::-webkit-scrollbar-thumb {
            background: #666;
            border-radius: 10px;
        }
        .chart-box::-webkit-scrollbar-thumb:hover {
            background: #888;
        }

        .sign-label {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.7em;
            color: #aaa; /* Light gray for faded elements */
            font-weight: normal;
            cursor: help;
        }

        .house-label {
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 0.75em;
            color: #ddd; /* Lighter gray for house numbers */
            font-weight: bold;
        }

        /* Styles to hide labels separately */
        .hide-sign-labels .sign-label {
            display: none;
        }
        .hide-house-numbers .house-label {
            display: none;
        }


        .planet {
            cursor: grab;
            margin: 1px;
            font-size: 0.8em;
            padding: 2px 4px;
            border-radius: 3px;
            display: flex;
            flex-direction: column;
            align-items: center;
            white-space: nowrap;
            user-select: none;
            transition: background-color 0.2s, opacity 0.2s, transform 0.1s;
            box-shadow: 0.5px 0.5px 2px rgba(255,255,255,0.1);
            position: relative;
            /* Default styles, overridden by specific planet colors */
            background-color: #333;
            color: #eee;
        }

        .planet-symbol {
            font-weight: bold;
            font-size: 1em;
        }

        .planet-degree-display {
            font-size: 0.7em;
            color: #ccc; /* Slightly darker white for degrees */
            margin-top: 1px;
        }

        /* UPDATED LAGNA STYLING */
        .Lagna {
            background-color: #fff; /* White background for Lagna */
            color: #333; /* Dark gray text for Lagna (IMPROVED VISIBILITY) */
            font-weight: bold;
        }
        .Lagna .planet-degree-display {
             color: #666; /* Slightly lighter gray for degree text for Lagna */
        }

        .planet:hover {
            transform: translateY(-1px);
            opacity: 0.9; /* Slightly reduce opacity on hover for all planets */
        }
        .Lagna:hover {
            background-color: #eee; /* Slightly darker white for Lagna on hover */
        }


        /* NEW: Improved Specific Planet Colors */
        .Sun { background-color: #d1b44b; color: #fff; } /* Muted Gold */
        .Moon { background-color: #92a8d1; color: #fff; } /* Soft Blue-Gray */
        .Mars { background-color: #c96d66; color: #fff; } /* Dusty Rose */
        .Mercury { background-color: #79b085; color: #fff; } /* Sage Green */
        .Jupiter { background-color: #c98c56; color: #fff; } /* Muted Orange-Brown */
        .Venus { background-color: #a38cba; color: #fff; } /* Lavender */
        .Saturn { background-color: #6a6a6a; color: #fff; } /* Medium Dark Gray */
        .Rahu { background-color: #6e8b74; color: #fff; } /* Darker Sage */
        .Ketu { background-color: #9c6c52; color: #fff; } /* Rusty Brown */

        /* Override degree display color for colored planets to ensure contrast */
        .Sun .planet-degree-display, .Moon .planet-degree-display, .Mars .planet-degree-display,
        .Mercury .planet-degree-display, .Jupiter .planet-degree-display, .Venus .planet-degree-display,
        .Saturn .planet-degree-display, .Rahu .planet-degree-display, .Ketu .planet-degree-display {
            color: #eee; /* Keep degrees visible on colored backgrounds */
        }


        .planet:active {
            cursor: grabbing;
        }

        .planets-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            width: 100%;
            min-height: 20px;
            margin-top: 12px;
            padding-top: 3px;
            gap: 2px;
        }

        .planets-container.drag-over {
            background-color: #2a2a2a; /* Darker gray highlight for drag-over */
            border: 1px dashed #999; /* Gray dashed border */
        }

        .controls {
            text-align: center;
            margin-top: 25px;
            padding: 15px;
            border: 1px solid #555;
            border-radius: 8px;
            background-color: #1a1a1a; /* Darker background for controls */
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.4);
            position: relative;
        }

        .controls div {
            margin-bottom: 10px;
        }

        .controls label,
        .controls span {
            font-weight: 500;
            margin-right: 8px;
            color: #fff; /* White text */
        }

        button {
            padding: 7px 14px;
            font-size: 0.95em;
            margin: 4px;
            border-radius: 4px;
            border: 1px solid #888; /* Gray border */
            background-color: transparent;
            color: #fff; /* White text */
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        button:hover {
            background-color: #555; /* Darker gray on hover */
            color: #fff;
            border-color: #fff; /* White border on hover */
        }

        button.secondary {
            border-color: #666; /* Slightly darker gray for secondary */
            color: #ccc; /* Lighter gray */
        }

        button.secondary:hover {
            background-color: #666;
            color: #fff;
        }

        #planet-bank {
            border: 1px dashed #444; /* Darker dashed border */
            padding: 8px;
            min-height: 35px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            margin-top: 8px;
            background-color: #1a1a1a;
        }

        /* Styles for the planet tooltip */
        .planet-tooltip {
            position: fixed;
            background-color: #333; /* Dark background for tooltip */
            color: #fff; /* White text */
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        .planet-tooltip.active {
            opacity: 1;
        }

        /* Styles for the sign/house tooltip */
        #sign-house-tooltip {
            position: fixed;
            background-color: #222; /* Even darker, distinct background */
            color: #fff;
            border: 1px solid #777; /* Gray border */
            padding: 10px 12px;
            border-radius: 6px;
            font-size: 0.85em;
            z-index: 102;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4);
            max-width: 250px;
            line-height: 1.4;
        }
        #sign-house-tooltip.active {
            opacity: 1;
        }
        #sign-house-tooltip p {
            margin: 0 0 5px 0;
        }
        #sign-house-tooltip p:last-child {
            margin-bottom: 0;
        }
        #sign-house-tooltip strong {
            color: #eee; /* Lighter white for strong text */
        }
        #sign-house-tooltip .tooltip-section-title {
            font-weight: bold;
            color: #ccc; /* Gray for section titles */
            margin-top: 8px;
            margin-bottom: 2px;
        }
        #sign-house-tooltip .tooltip-section-title:first-child {
            margin-top: 0;
        }


        /* Styles for the Retrograde Panel */
        #retrograde-panel {
            position: fixed;
            background-color: #222;
            border: 1px solid #777;
            border-radius: 5px;
            padding: 10px 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            z-index: 101;
            display: none;
            flex-direction: column;
            gap: 8px;
        }
        #retrograde-panel.active {
            display: flex;
        }
        #retrograde-panel label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            color: #fff;
            font-size: 0.9em;
        }
        #retrograde-panel input[type="checkbox"] {
            transform: scale(1.2);
            cursor: pointer;
        }
        #retrograde-panel .panel-planet-name {
            font-weight: bold;
            color: #eee; /* Lighter white */
            font-size: 1.1em;
        }

        /* Style for retrograde symbol (R) next to planet symbol */
        .planet.retrograde .retrograde-symbol {
            font-size: 0.9em;
            color: #ff3333; /* A subtle red for retrograde to stand out minimally, can be changed to white/gray */
            font-weight: bold;
            margin-left: 2px;
            vertical-align: super;
        }
        /* If you want pure black and white, make retrograde symbol white/gray */
        /* .planet.retrograde .retrograde-symbol {
            color: #fff;
        } */


        /* Language selector */
        .language-selector-container {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            color: #fff;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .language-selector-container select {
            padding: 5px 8px;
            border-radius: 4px;
            border: 1px solid #888; /* Gray border */
            background-color: #1a1a1a; /* Dark background */
            color: #fff; /* White text */
            cursor: pointer;
            font-size: 0.9em;
        }

        .language-selector-container select:focus {
            outline: none;
            border-color: #fff; /* White focus border */
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.3);
        }

        .toggle-options-group {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: #fff;
            font-size: 0.9em;
        }

        .toggle-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-option input[type="checkbox"] {
            transform: scale(1.2);
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="language-selector-container">
        <label for="language-select">Language:</label>
        <select id="language-select">
            <option value="en">English</option>
            <option value="hi">हिंदी (Hindi)</option>
            <option value="te">తెలుగు (Telugu)</option>
            <option value="ta">தமிழ் (Tamil)</option>
        </select>
    </div>

    <div class="chart-title">Interactive South Indian Vedic Astrology Chart</div>

    <div class="chart-container" id="chart-container">
        <div class="chart-box" data-sign="Pisces">
            <div class="sign-label">Pi</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Pisces"></div>
        </div>
        <div class="chart-box" data-sign="Aries">
            <div class="sign-label">Ar</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Aries"></div>
        </div>
        <div class="chart-box" data-sign="Taurus">
            <div class="sign-label">Ta</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Taurus"></div>
        </div>
        <div class="chart-box" data-sign="Gemini">
            <div class="sign-label">Ge</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Gemini"></div>
        </div>
        <div class="chart-box" data-sign="Aquarius">
            <div class="sign-label">Aq</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Aquarius"></div>
        </div>
        <div class="chart-box empty-box"></div>
        <div class="chart-box empty-box"></div>
        <div class="chart-box" data-sign="Cancer">
            <div class="sign-label">Cn</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Cancer"></div>
        </div>
        <div class="chart-box" data-sign="Capricorn">
            <div class="sign-label">Cp</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Capricorn"></div>
        </div>
        <div class="chart-box empty-box"></div>
        <div class="chart-box empty-box"></div>
        <div class="chart-box" data-sign="Leo">
            <div class="sign-label">Le</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Leo"></div>
        </div>
        <div class="chart-box" data-sign="Sagittarius">
            <div class="sign-label">Sg</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Sagittarius"></div>
        </div>
        <div class="chart-box" data-sign="Scorpio">
            <div class="sign-label">Sc</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Scorpio"></div>
        </div>
        <div class="chart-box" data-sign="Libra">
            <div class="sign-label">Li</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Libra"></div>
        </div>
        <div class="chart-box" data-sign="Virgo">
            <div class="sign-label">Vi</div>
            <div class="house-label"></div>
            <div class="planets-container" data-sign="Virgo"></div>
        </div>
    </div>

    <div class="controls">
        <div>
            <span>Drag Planets to Chart (Double-click or drag to bank to remove):</span>
            <div id="planet-bank">
                <span class="planet Lagna" draggable="true" id="Lagna"><span class="planet-symbol">L</span></span>
                <span class="planet Sun" draggable="true" id="Sun"><span class="planet-symbol">Su</span></span>
                <span class="planet Moon" draggable="true" id="Moon"><span class="planet-symbol">Mo</span></span>
                <span class="planet Mars" draggable="true" id="Mars"><span class="planet-symbol">Ma</span></span>
                <span class="planet Mercury" draggable="true" id="Mercury"><span class="planet-symbol">Me</span></span>
                <span class="planet Jupiter" draggable="true" id="Jupiter"><span class="planet-symbol">Ju</span></span>
                <span class="planet Venus" draggable="true" id="Venus"><span class="planet-symbol">Ve</span></span>
                <span class="planet Saturn" draggable="true" id="Saturn"><span class="planet-symbol">Sa</span></span>
                <span class="planet Rahu" draggable="true" id="Rahu"><span class="planet-symbol">Ra</span></span>
                <span class="planet Ketu" draggable="true" id="Ketu"><span class="planet-symbol">Ke</span></span>
            </div>
        </div>
        <button onclick="resetChart()">Clear Chart</button>
        <p>Tip: Click and drag a planet in the chart up or down to adjust its degree.</p>
        <div class="toggle-options-group">
            <div class="toggle-option">
                <input type="checkbox" id="toggle-sign-labels-checkbox">
                <label for="toggle-sign-labels-checkbox">Hide Sign Labels</label>
            </div>
            <div class="toggle-option">
                <input type="checkbox" id="toggle-house-numbers-checkbox">
                <label for="toggle-house-numbers-checkbox">Hide House Numbers</label>
            </div>
        </div>
    </div>

    <div id="planet-tooltip" class="planet-tooltip"></div>

    <div id="sign-house-tooltip"></div>

    <div id="retrograde-panel">
        <div class="panel-planet-name"></div>
        <label>
            <input type="checkbox" id="retrograde-checkbox"> Retrograde
        </label>
    </div>

    <script>
        const signs = ["Aries", "Taurus", "Gemini", "Cancer", "Leo", "Virgo", "Libra", "Scorpio", "Sagittarius", "Capricorn", "Aquarius", "Pisces"];

        // signData and houseData now contain *English keys* that map to the translations object
        const signData = {
            "Aries": { ruler: "Mars", element: "Fire", modality: "Cardinal" },
            "Taurus": { ruler: "Venus", element: "Earth", modality: "Fixed" },
            "Gemini": { ruler: "Mercury", element: "Air", modality: "Dual" },
            "Cancer": { ruler: "Moon", element: "Water", modality: "Cardinal" },
            "Leo": { ruler: "Sun", element: "Fire", modality: "Fixed" },
            "Virgo": { ruler: "Mercury", element: "Earth", modality: "Dual" },
            "Libra": { ruler: "Venus", element: "Air", modality: "Cardinal" },
            "Scorpio": { ruler: "Mars", element: "Water", modality: "Fixed" },
            "Sagittarius": { ruler: "Jupiter", element: "Fire", modality: "Dual" },
            "Capricorn": { ruler: "Saturn", element: "Earth", modality: "Cardinal" },
            "Aquarius": { ruler: "Saturn", element: "Air", modality: "Fixed" },
            "Pisces": { ruler: "Jupiter", element: "Water", modality: "Dual" }
        };

        const houseData = { // Only needs keys for lookup
            1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {},
            7: {}, 8: {}, 9: {}, 10: {}, 11: {}, 12: {}
        };

        const nakshatras = [
            { name: 'Ashwini', range: '0° – 13°20′ Aries', ruler: 'Ketu', symbol: 'Horse Head', deity: 'Ashwini Kumaras' },
            { name: 'Bharani', range: '13°20′ – 26°40′ Aries', ruler: 'Venus', symbol: 'Yoni', deity: 'Yama' },
            { name: 'Krittika', range: '26°40′ Aries – 10° Taurus', ruler: 'Sun', symbol: 'Razor/Axe', deity: 'Agni' },
            { name: 'Rohini', range: '10° – 23°20′ Taurus', ruler: 'Moon', symbol: 'Cart/Chariot', deity: 'Brahma' },
            { name: 'Mrigashira', range: '23°20′ Taurus – 6°40′ Gemini', ruler: 'Mars', symbol: 'Deer Head', deity: 'Soma (Moon)' },
            { name: 'Ardra', range: '6°40′ – 20° Gemini', ruler: 'Rahu', symbol: 'Teardrop/Diamond', deity: 'Rudra (Shiva)' },
            { name: 'Punarvasu', range: '20° Gemini – 3°20′ Cancer', ruler: 'Jupiter', symbol: 'Quiver of Arrows', deity: 'Aditi' },
            { name: 'Pushya', range: '3°20′ – 16°40′ Cancer', ruler: 'Saturn', symbol: 'Cow Udder', deity: 'Brihaspati (Jupiter)' },
            { name: 'Ashlesha', range: '16°40′ – 30° Cancer', ruler: 'Mercury', symbol: 'Coiled Serpent', deity: 'Nagas (Serpents)' },
            { name: 'Magha', range: '0° – 13°20′ Leo', ruler: 'Ketu', symbol: 'Royal Throne', deity: 'Pitri (Ancestors)' },
            { name: 'Purva Phalguni', range: '13°20′ – 26°40′ Leo', ruler: 'Venus', symbol: 'Front Legs of Bed', deity: 'Bhaga (God of Wealth)' },
            { name: 'Uttara Phalguni', range: '26°40′ Leo – 10° Virgo', ruler: 'Sun', symbol: 'Back Legs of Bed', deity: 'Aryaman' },
            { name: 'Hasta', range: '10° – 23°20′ Virgo', ruler: 'Moon', symbol: 'Hand', deity: 'Savitar (Sun God)' },
            { name: 'Chitra', range: '23°20′ Virgo – 6°40′ Libra', ruler: 'Mars', symbol: 'Pearl', deity: 'Vishwakarma' },
            { name: 'Swati', range: '6°40′ – 20° Libra', ruler: 'Rahu', symbol: 'Coral/Sword', deity: 'Vayu (Wind God)' },
            { name: 'Vishakha', range: '20° Libra – 3°20′ Scorpio', ruler: 'Jupiter', symbol: 'Triumphal Arch', deity: 'Indragni' },
            { name: 'Anuradha', range: '3°20′ – 16°40′ Scorpio', ruler: 'Saturn', symbol: 'Lotus', deity: 'Mitra (Sun God)' },
            { name: 'Jyeshtha', range: '16°40′ – 30° Scorpio', ruler: 'Mercury', symbol: 'Earring/Umbrella', deity: 'Indra' },
            { name: 'Moola', range: '0° – 13°20′ Sagittarius', ruler: 'Ketu', symbol: 'Root', deity: 'Nirriti (Goddess of Calamity)' },
            { name: 'Purva Ashadha', range: '13°20′ – 26°40′ Sagittarius', ruler: 'Venus', symbol: 'Elephant Tusk/Fan', deity: 'Apah (Water Goddess)' },
            { name: 'Uttara Ashadha', range: '26°40′ Sagittarius – 10° Capricorn', ruler: 'Sun', symbol: 'Elephant Tusk/Plank', deity: 'Vishvadevas' },
            { name: 'Shravana', range: '10° – 23°20′ Capricorn', ruler: 'Moon', symbol: 'Ear', deity: 'Vishnu' },
            { name: 'Dhanishta', range: '23°20′ Capricorn – 6°40′ Aquarius', ruler: 'Mars', symbol: 'Musical Drum', deity: 'Vasu (Gods of Light)' },
            { name: 'Shatabhisha', range: '6°40′ – 20° Aquarius', ruler: 'Rahu', symbol: '100 Physicians/Stars', deity: 'Varuna (God of Cosmic Law)' },
            { name: 'Purva Bhadrapada', range: '20° Aquarius – 3°20′ Pisces', ruler: 'Jupiter', symbol: 'Front Legs of Funeral Cot', deity: 'Aja Ekapad' },
            { name: 'Uttara Bhadrapada', range: '3°20′ – 16°40′ Pisces', ruler: 'Saturn', symbol: 'Back Legs of Funeral Cot', deity: 'Ahir Bhudhanya' },
            { name: 'Revati', range: '16°40′ – 30° Pisces', ruler: 'Mercury', symbol: 'Drum/Fish', deity: 'Pushan (Nourishment)' }
        ];

        const translations = {
            "en": {
                "chartTitle": "Interactive South Indian Vedic Astrology Chart",
                "dragTip": "Drag Planets to Chart (Double-click or drag to bank to remove):",
                "clearChart": "Clear Chart",
                "degreeTip": "Tip: Click and drag a planet in the chart up or down to adjust its degree.",
                "hideSignLabelsOption": "Hide Sign Labels",
                "hideHouseNumbersOption": "Hide House Numbers",
                "lagnaSymbol": "L",
                "sunSymbol": "Su",
                "moonSymbol": "Mo",
                "marsSymbol": "Ma",
                "mercurySymbol": "Me",
                "jupiterSymbol": "Ju",
                "venusSymbol": "Ve",
                "saturnSymbol": "Sa",
                "rahuSymbol": "Ra",
                "ketuSymbol": "Ke",
                "retrogradeCheckbox": "Retrograde",
                "planetColon": "Planet:",
                "tooltipDegreeSign": "°",
                "tooltipRetrograde": "(Retrograde)",
                "tooltipHouse": "House:",
                "tooltipHouseNotAssigned": "Not assigned (Set Lagna)",
                "tooltipHouseKeywords": "House Keywords:",
                "tooltipSignKeywords": "Sign Keywords:",
                "tooltipSignProperties": "Sign Properties:",
                "tooltipRuler": "Ruler:",
                "tooltipElement": "Element:",
                "tooltipModality": "Modality:",

                // Signs
                "sign_Aries": "Aries", "sign_Taurus": "Taurus", "sign_Gemini": "Gemini",
                "sign_Cancer": "Cancer", "sign_Leo": "Leo", "sign_Virgo": "Virgo",
                "sign_Libra": "Libra", "sign_Scorpio": "Scorpio", "sign_Sagittarius": "Sagittarius",
                "sign_Capricorn": "Capricorn", "sign_Aquarius": "Aquarius", "sign_Pisces": "Pisces",

                // Nakshatras
                "nak_Ashwini": "Ashwini", "nak_Bharani": "Bharani", "nak_Krittika": "Krittika",
                "nak_Rohini": "Rohini", "nak_Mrigashira": "Mrigashira", "nak_Ardra": "Ardra",
                "nak_Punarvasu": "Punarvasu", "nak_Pushya": "Pushya", "nak_Ashlesha": "Ashlesha",
                "nak_Magha": "Magha", "nak_Purva Phalguni": "Purva Phalguni", "nak_Uttara Phalguni": "Uttara Phalguni",
                "nak_Hasta": "Hasta", "nak_Chitra": "Chitra", "nak_Swati": "Swati",
                "nak_Vishakha": "Vishakha", "nak_Anuradha": "Anuradha", "nak_Jyeshtha": "Jyeshtha",
                "nak_Moola": "Moola", "nak_Purva Ashadha": "Purva Ashadha", "nak_Uttara Ashadha": "Uttara Ashadha",
                "nak_Shravana": "Shravana", "nak_Dhanishta": "Dhanishta", "nak_Shatabhisha": "Shatabhisha",
                "nak_Purva Bhadrapada": "Purva Bhadrapada", "nak_Uttara Bhadrapada": "Uttara Bhadrapada",
                "nak_Revati": "Revati",

                // Sign Properties (Ruler, Element, Modality - these are also translated now)
                "ruler_Sun": "Sun", "ruler_Moon": "Moon", "ruler_Mars": "Mars", "ruler_Mercury": "Mercury",
                "ruler_Jupiter": "Jupiter", "ruler_Venus": "Venus", "ruler_Saturn": "Saturn",

                "element_Fire": "Fire", "element_Earth": "Earth", "element_Air": "Air", "element_Water": "Water",

                "modality_Cardinal": "Cardinal", "modality_Fixed": "Fixed", "modality_Dual": "Dual",

                // Sign Keywords (moved here)
                "keywords_Aries": "Action, pioneering, assertive, impulsive, leadership, courage",
                "keywords_Taurus": "Stability, security, persistent, sensual, grounded, pleasure-seeking",
                "keywords_Gemini": "Communication, curious, versatile, intelligent, social, restless",
                "keywords_Cancer": "Nurturing, emotional, home, intuition, protective, sensitive",
                "keywords_Leo": "Creativity, self-expression, confident, generous, dramatic, loyal",
                "keywords_Virgo": "Analysis, service, practical, perfectionist, health-conscious, diligent",
                "keywords_Libra": "Balance, harmony, relationships, justice, diplomatic, aesthetic",
                "keywords_Scorpio": "Transformation, intensity, secretive, powerful, passionate, investigative",
                "keywords_Sagittarius": "Expansion, wisdom, adventurous, optimistic, philosophical, free-spirited",
                "keywords_Capricorn": "Discipline, ambition, responsibility, structured, practical, patient",
                "keywords_Aquarius": "Innovation, humanitarian, independent, intellectual, unconventional, visionary",
                "keywords_Pisces": "Spirituality, compassion, artistic, empathetic, dreamy, sensitive",

                // House Keywords (moved here)
                "keywords_house_1": "Self, personality, physical body, appearance, vitality, beginnings",
                "keywords_house_2": "Resources, wealth, values, speech, family, possessions",
                "keywords_house_3": "Siblings, courage, communication, short journeys, writing, effort",
                "keywords_house_4": "Mother, home, land, inner peace, happiness, property",
                "keywords_house_5": "Children, creativity, intelligence, speculation, romance, past life karma",
                "keywords_house_6": "Debts, enemies, disease, service, daily routine, challenges",
                "keywords_house_7": "Marriage, partnerships, business, open enemies, foreign lands",
                "keywords_house_8": "Longevity, inheritance, occult, transformation, hidden matters, sudden events",
                "keywords_house_9": "Father, guru, higher education, philosophy, long journeys, fortune",
                "keywords_house_10": "Career, public image, reputation, status, ambition, achievements",
                "keywords_house_11": "Gains, friends, desires, elder siblings, income, hopes",
                "keywords_house_12": "Losses, expenditure, foreign settlement, spirituality, liberation, hidden enemies"
            },
            "hi": {
                "chartTitle": "इंटरेक्टिव दक्षिण भारतीय वैदिक ज्योतिष चार्ट",
                "dragTip": "ग्रहों को चार्ट पर खींचें (हटाने के लिए डबल-क्लिक करें या बैंक में खींचें):",
                "clearChart": "चार्ट साफ़ करें",
                "degreeTip": "सुझाव: ग्रह की डिग्री समायोजित करने के लिए चार्ट में एक ग्रह को ऊपर या नीचे क्लिक करके खींचें।",
                "hideSignLabelsOption": "राशि लेबल छिपाएँ",
                "hideHouseNumbersOption": "भाव संख्याएँ छिपाएँ",
                "lagnaSymbol": "ल",
                "sunSymbol": "सू",
                "moonSymbol": "चं",
                "marsSymbol": "मं",
                "mercurySymbol": "बु",
                "jupiterSymbol": "गु",
                "venusSymbol": "शु",
                "saturnSymbol": "श",
                "rahuSymbol": "रा",
                "ketuSymbol": "के",
                "retrogradeCheckbox": "वक्री",
                "planetColon": "ग्रह:",
                "tooltipDegreeSign": "°",
                "tooltipRetrograde": "(वक्री)",
                "tooltipHouse": "भाव:",
                "tooltipHouseNotAssigned": "असाइन नहीं किया गया (लग्न सेट करें)",
                "tooltipHouseKeywords": "भाव के प्रमुख शब्द:",
                "tooltipSignKeywords": "राशि के प्रमुख शब्द:",
                "tooltipSignProperties": "राशि के गुण:",
                "tooltipRuler": "स्वामी:",
                "tooltipElement": "तत्व:",
                "tooltipModality": "प्रकृति:",

                // Signs
                "sign_Aries": "मेष", "sign_Taurus": "वृषभ", "sign_Gemini": "मिथुन",
                "sign_Cancer": "कर्क", "sign_Leo": "सिंह", "sign_Virgo": "कन्या",
                "sign_Libra": "तुला", "sign_Scorpio": "वृश्चिक", "sign_Sagittarius": "धनु",
                "sign_Capricorn": "मकर", "sign_Aquarius": "कुंभ", "sign_Pisces": "मीन",

                // Nakshatras
                "nak_Ashwini": "अश्विनी", "nak_Bharani": "भरणी", "nak_Krittika": "कृतिका",
                "nak_Rohini": "रोहिणी", "nak_Mrigashira": "मृगशिरा", "nak_Ardra": "आर्द्रा",
                "nak_Punarvasu": "पुनर्वसु", "nak_Pushya": "पुष्य", "nak_Ashlesha": "आश्लेषा",
                "nak_Magha": "मघा", "nak_Purva Phalguni": "पूर्वा फाल्गुनी", "nak_Uttara Phalguni": "उत्तरा फाल्गुनी",
                "nak_Hasta": "हस्त", "nak_Chitra": "चित्रा", "nak_Swati": "स्वाति",
                "nak_Vishakha": "विशाखा", "nak_Anuradha": "अनुराधा", "nak_Jyeshtha": "ज्येष्ठा",
                "nak_Moola": "मूल", "nak_Purva Ashadha": "पूर्वाषाढ़ा", "nak_Uttara Ashadha": "उत्तराषाढ़ा",
                "nak_Shravana": "श्रवण", "nak_Dhanishta": "धनिष्ठा", "nak_Shatabhisha": "शतभिषा",
                "nak_Purva Bhadrapada": "पूर्वा भाद्रपदा", "nak_Uttara Bhadrapada": "उत्तरा भाद्रपदा",
                "nak_Revati": "रेवती",

                // Sign Properties (Ruler, Element, Modality)
                "ruler_Sun": "सूर्य", "ruler_Moon": "चंद्र", "ruler_Mars": "मंगल", "ruler_Mercury": "बुध",
                "ruler_Jupiter": "बृहस्पति", "ruler_Venus": "शुक्र", "ruler_Saturn": "शनि",

                "element_Fire": "अग्नि", "element_Earth": "पृथ्वी", "element_Air": "वायु", "element_Water": "जल",

                "modality_Cardinal": "चर", "modality_Fixed": "स्थिर", "modality_Dual": "द्विस्वभाव",

                // Sign Keywords (Hindi translations - IMPORTANT: VERIFY THESE FOR ACCURACY!)
                "keywords_Aries": "कार्य, अग्रणी, मुखर, आवेगी, नेतृत्व, साहस",
                "keywords_Taurus": "स्थिरता, सुरक्षा, दृढ़, कामुक, जमीनी, सुख-चाहने वाला",
                "keywords_Gemini": "संचार, जिज्ञासु, बहुमुखी, बुद्धिमान, सामाजिक, बेचैन",
                "keywords_Cancer": "पोषण, भावनात्मक, घर, अंतर्ज्ञान, सुरक्षात्मक, संवेदनशील",
                "keywords_Leo": "रचनात्मकता, आत्म-अभिव्यक्ति, आत्मविश्वासी, उदार, नाटकीय, वफादार",
                "keywords_Virgo": "विश्लेषण, सेवा, व्यावहारिक, पूर्णतावादी, स्वास्थ्य-सचेत, मेहनती",
                "keywords_Libra": "संतुलन, सद्भाव, रिश्ते, न्याय, कूटनीतिक, सौंदर्य",
                "keywords_Scorpio": "परिवर्तन, तीव्रता, रहस्यमयी, शक्तिशाली, भावुक, खोजी",
                "keywords_Sagittarius": "विस्तार, ज्ञान, साहसिक, आशावादी, दार्शनिक, स्वतंत्र आत्मा",
                "keywords_Capricorn": "अनुशासन, महत्वाकांक्षा, जिम्मेदारी, संरचित, व्यावहारिक, धैर्यवान",
                "keywords_Aquarius": "नवाचार, मानवतावादी, स्वतंत्र, बौद्धिक, अपरंपरागत, दूरदर्शी",
                "keywords_Pisces": "आध्यात्मिकता, करुणा, कलात्मक, सहानुभूतिपूर्ण, स्वप्निल, संवेदनशील",

                // House Keywords (Hindi translations - IMPORTANT: VERIFY THESE FOR ACCURACY!)
                "keywords_house_1": "स्वयं, व्यक्तित्व, भौतिक शरीर, उपस्थिति, जीवन शक्ति, शुरुआत",
                "keywords_house_2": "संसाधन, धन, मूल्य, वाणी, परिवार, संपत्ति",
                "keywords_house_3": "भाई-बहन, साहस, संचार, छोटी यात्राएँ, लेखन, प्रयास",
                "keywords_house_4": "माँ, घर, भूमि, आंतरिक शांति, खुशी, संपत्ति",
                "keywords_house_5": "बच्चे, रचनात्मकता, बुद्धि, अटकलें, रोमांस, पूर्व जन्म का कर्म",
                "keywords_house_6": "ऋण, शत्रु, रोग, सेवा, दैनिक दिनचर्या, चुनौतियाँ",
                "keywords_house_7": "विवाह, साझेदारी, व्यवसाय, खुले शत्रु, विदेशी भूमि",
                "keywords_house_8": "दीर्घायु, विरासत, गुप्त, परिवर्तन, छिपी हुई बातें, अचानक घटनाएँ",
                "keywords_house_9": "पिता, गुरु, उच्च शिक्षा, दर्शन, लंबी यात्राएँ, भाग्य",
                "keywords_house_10": "करियर, सार्वजनिक छवि, प्रतिष्ठा, स्थिति, महत्वाकांक्षा, उपलब्धियाँ",
                "keywords_house_11": "लाभ, मित्र, इच्छाएँ, बड़े भाई-बहन, आय, आशाएँ",
                "keywords_house_12": "हानियाँ, व्यय, विदेशी समझौता, आध्यात्मिकता, मुक्ति, छिपे हुए शत्रु"
            },
            "te": {
                "chartTitle": "ఇంటరాక్టివ్ దక్షిణ భారతీయ జ్యోతిష్య చార్ట్",
                "dragTip": "గ్రహాలను చార్ట్‌లోకి లాగండి (తొలగించడానికి డబుల్-క్లిక్ చేయండి లేదా బ్యాంక్‌కు లాగండి):",
                "clearChart": "చార్ట్ క్లియర్ చేయండి",
                "degreeTip": "చిట్కా: గ్రహం యొక్క డిగ్రీని సర్దుబాటు చేయడానికి చార్ట్‌లోని గ్రహాన్ని పైకి లేదా క్రిందికి క్లిక్ చేసి లాగండి.",
                "hideSignLabelsOption": "రాశి లేబుల్‌లను దాచు",
                "hideHouseNumbersOption": "భావం సంఖ్యలను దాచు",
                "lagnaSymbol": "ల",
                "sunSymbol": "సూ",
                "moonSymbol": "చం",
                "marsSymbol": "కు",
                "mercurySymbol": "బు",
                "jupiterSymbol": "గు",
                "venusSymbol": "శు",
                "saturnSymbol": "శ",
                "rahuSymbol": "రా",
                "ketuSymbol": "కే",
                "retrogradeCheckbox": "వక్రీ",
                "planetColon": "గ్రహం:",
                "tooltipDegreeSign": "°",
                "tooltipRetrograde": "(వక్రీ)",
                "tooltipHouse": "భావం:",
                "tooltipHouseNotAssigned": "కేటాయించబడలేదు (లగ్నను సెట్ చేయండి)",
                "tooltipHouseKeywords": "భావం కీలక పదాలు:",
                "tooltipSignKeywords": "రాశి కీలక పదాలు:",
                "tooltipSignProperties": "రాశి లక్షణాలు:",
                "tooltipRuler": "అధిపతి:",
                "tooltipElement": "మూలకం:",
                "tooltipModality": "విధానం:",

                // Signs
                "sign_Aries": "మేషం", "sign_Taurus": "వృషభం", "sign_Gemini": "మిథునం",
                "sign_Cancer": "కర్కాటకం", "sign_Leo": "సింహం", "sign_Virgo": "కన్య",
                "sign_Libra": "తుల", "sign_Scorpio": "వృశ్చికం", "sign_Sagittarius": "ధనుస్సు",
                "sign_Capricorn": "మకరం", "sign_Aquarius": "కుంభం", "sign_Pisces": "మీనం",

                // Nakshatras
                "nak_Ashwini": "అశ్విని", "nak_Bharani": "భరణి", "nak_Krittika": "కృత్తిక",
                "nak_Rohini": "రోహిణి", "nak_Mrigashira": "మృగశిర", "nak_Ardra": "ఆర్ద్ర",
                "nak_Punarvasu": "పునర్వసు", "nak_Pushya": "పుష్యమి", "nak_Ashlesha": "ఆశ్లేష",
                "nak_Magha": "మఖ", "nak_Purva Phalguni": "పూర్వ ఫాల్గుణి", "nak_Uttara Phalguni": "ఉత్తర ఫాల్గుణి",
                "nak_Hasta": "హస్త", "nak_Chitra": "చిత్ర", "nak_Swati": "స్వాతి",
                "nak_Vishakha": "విశాఖ", "nak_Anuradha": "అనురాధ", "nak_Jyeshtha": "జ్యేష్ఠ",
                "nak_Moola": "మూల", "nak_Purva Ashadha": "పూర్వాషాఢ", "nak_Uttara Ashadha": "ఉత్తరాషాఢ",
                "nak_Shravana": "శ్రవణం", "nak_Dhanishta": "ధనిష్ఠ", "nak_Shatabhisha": "శతభిషం",
                "nak_Purva Bhadrapada": "పూర్వ భాద్రపద", "nak_Uttara Bhadrapada": "ఉత్తరా భాద్రపద",
                "nak_Revati": "రేవతి",

                // Sign Properties (Ruler, Element, Modality)
                "ruler_Sun": "సూర్యుడు", "ruler_Moon": "చంద్రుడు", "ruler_Mars": "కుజుడు", "ruler_Mercury": "బుధుడు",
                "ruler_Jupiter": "గురువు", "ruler_Venus": "శుక్రుడు", "ruler_Saturn": "శని",

                "element_Fire": "అగ్ని", "element_Earth": "భూమి", "element_Air": "గాలి", "element_Water": "నీరు",

                "modality_Cardinal": "చర", "modality_Fixed": "స్థిర", "modality_Dual": "ద్విస్వభావం",

                // Sign Keywords (Telugu translations - IMPORTANT: VERIFY THESE FOR ACCURACY!)
                "keywords_Aries": "చర్య, మార్గదర్శకత్వం, దృఢత్వం, ఆవేశం, నాయకత్వం, ధైర్యం",
                "keywords_Taurus": "స్థిరత్వం, భద్రత, నిలకడ, ఇంద్రియజ్ఞానం, మట్టితో కూడిన, ఆనందాన్ని కోరేది",
                "keywords_Gemini": "కమ్యూనికేషన్, జిజ్ఞాస, బహుముఖ ప్రజ్ఞ, తెలివైన, సామాజిక, విశ్రాంతి లేని",
                "keywords_Cancer": "పోషించేది, భావోద్వేగమైనది, ఇల్లు, అంతర్జ్ఞానం, రక్షణ, సున్నితమైన",
                "keywords_Leo": "సృజనాత్మకత, స్వీయ-వ్యక్తీకరణ, ఆత్మవిశ్వాసం, ఉదారమైన, నాటకీయమైన, నమ్మకమైన",
                "keywords_Virgo": "విశ్లేషణ, సేవ, ఆచరణాత్మక, పరిపూర్ణత, ఆరోగ్య స్పృహ, శ్రద్ధగల",
                "keywords_Libra": "సమతుల్యత, సామరస్యం, సంబంధాలు, న్యాయం, దౌత్యం, సౌందర్యం",
                "keywords_Scorpio": "పరివర్తన, తీవ్రత, రహస్యమైన, శక్తివంతమైన, ఉద్వేగభరితమైన, పరిశోధనాత్మక",
                "keywords_Sagittarius": "విస్తరణ, జ్ఞానం, సాహసం, ఆశావాదం, తాత్విక, స్వేచ్ఛా స్ఫూర్తి",
                "keywords_Capricorn": "క్రమశిక్షణ, ఆశయం, బాధ్యత, నిర్మాణాత్మక, ఆచరణాత్మక, ఓపికగల",
                "keywords_Aquarius": "ఆవిష్కరణ, మానవతావాదం, స్వతంత్రం, మేధో, అసాధారణ, దార్శనిక",
                "keywords_Pisces": "ఆధ్యాత్మికత, కరుణ, కళాత్మక, సానుభూతి, కలలు కనే, సున్నితమైన",

                // House Keywords (Telugu translations - IMPORTANT: VERIFY THESE FOR ACCURACY!)
                "keywords_house_1": "స్వయం, వ్యక్తిత్వం, భౌతిక శరీరం, రూపు, జీవశక్తి, ఆరంభాలు",
                "keywords_house_2": "వనరులు, సంపద, విలువలు, మాట, కుటుంబం, ఆస్తులు",
                "keywords_house_3": "తోబుట్టువులు, ధైర్యం, కమ్యూనికేషన్, చిన్న ప్రయాణాలు, రచన, ప్రయత్నం",
                "keywords_house_4": "తల్లి, ఇల్లు, భూమి, అంతర్గత శాంతి, ఆనందం, ఆస్తి",
                "keywords_house_5": "పిల్లలు, సృజనాత్మకత, తెలివితేటలు, ఊహాగానాలు, శృంగారం, పూర్వ జన్మ కర్మ",
                "keywords_house_6": "రుణాలు, శత్రువులు, వ్యాధి, సేవ, దైనందిన దినచర్య, సవాళ్లు",
                "keywords_house_7": "వివాహం, భాగస్వామ్యాలు, వ్యాపారం, బహిరంగ శత్రువులు, విదేశీ భూములు",
                "keywords_house_8": "దీర్ఘాయువు, వారసత్వం, రహస్యం, పరివర్తన, దాగి ఉన్న విషయాలు, ఆకస్మిక సంఘటనలు",
                "keywords_house_9": "తండ్రి, గురువు, ఉన్నత విద్య, తత్వశాస్త్రం, సుదూర ప్రయాణాలు, అదృష్టం",
                "keywords_house_10": "వృత్తి, ప్రజా ప్రతిష్ట, కీర్తి, హోదా, ఆశయం, విజయాలు",
                "keywords_house_11": "లాభాలు, స్నేహితులు, కోరికలు, పెద్ద తోబుట్టువులు, ఆదాయం, ఆశలు",
                "keywords_house_12": "నష్టాలు, వ్యయం, విదేశీ పరిష్కారం, ఆధ్యాత్మికత, విముక్తి, దాగి ఉన్న శత్రువులు"
            },
            "ta": {
                "chartTitle": "ஊடாடும் தென் இந்திய வேத ஜோதிட விளக்கப்படம்",
                "dragTip": "கிரகங்களை விளக்கப்படத்திற்கு இழுக்கவும் (நீக்க இருமுறை கிளிக் செய்யவும் அல்லது வங்கிக்கு இழுக்கவும்):",
                "clearChart": "விளக்கப்படத்தை அழி",
                "degreeTip": "குறிப்பு: விளக்கப்படத்தில் உள்ள ஒரு கிரகத்தின் டிகிரியை சரிசெய்ய அதைக் கிளிக் செய்து மேலும் கீழும் இழுக்கவும்.",
                "hideSignLabelsOption": "ராசி லேபிள்களை மறை",
                "hideHouseNumbersOption": "பாவம் எண்களை மறை",
                "lagnaSymbol": "ல",
                "sunSymbol": "சூ",
                "moonSymbol": "ச",
                "marsSymbol": "செ",
                "mercurySymbol": "பு",
                "jupiterSymbol": "குரு",
                "venusSymbol": "சு",
                "saturnSymbol": "சனி",
                "rahuSymbol": "ரா",
                "ketuSymbol": "கே",
                "retrogradeCheckbox": "வக்ரம்",
                "planetColon": "கிரகம்:",
                "tooltipDegreeSign": "°",
                "tooltipRetrograde": "(வக்ரம்)",
                "tooltipHouse": "பாவம்:",
                "tooltipHouseNotAssigned": "ஒதுக்கப்படவில்லை (லக்னத்தை அமைக்கவும்)",
                "tooltipHouseKeywords": "பாவம் முக்கிய வார்த்தைகள்:",
                "tooltipSignKeywords": "ராசி முக்கிய வார்த்தைகள்:",
                "tooltipSignProperties": "ராசி பண்புகள்:",
                "tooltipRuler": "அதிபதி:",
                "tooltipElement": "மூலகம்:",
                "tooltipModality": "வழிமுறை:",

                // Signs
                "sign_Aries": "மேஷம்", "sign_Taurus": "ரிஷபம்", "sign_Gemini": "மிதுனம்",
                "sign_Cancer": "கடகம்", "sign_Leo": "சிம்மம்", "sign_Virgo": "கன்னி",
                "sign_Libra": "துலாம்", "sign_Scorpio": "விருச்சிகம்", "sign_Sagittarius": "தனுசு",
                "sign_Capricorn": "மகரம்", "sign_Aquarius": "கும்பம்", "sign_Pisces": "மீனம்",

                // Nakshatras
                "nak_Ashwini": "அஸ்வினி", "nak_Bharani": "பரணி", "nak_Krittika": "கிருத்திகை",
                "nak_Rohini": "ரோகிணி", "nak_Mrigashira": "மிருகசீரிஷம்", "nak_Ardra": "திருவாதிரை",
                "nak_Punarvasu": "புனர்பூசம்", "nak_Pushya": "பூசம்",
                "nak_Ashlesha": "ஆயில்யம்", "nak_Magha": "மகம்",
                "nak_Purva Phalguni": "பூரம்", "nak_Uttara Phalguni": "உத்திரம்",
                "nak_Hasta": "அஸ்தம்", "nak_Chitra": "சித்திரை", "nak_Swati": "சுவாதி",
                "nak_Vishakha": "விசாகம்", "nak_Anuradha": "அனுஷம்", "nak_Jyeshtha": "கேட்டை",
                "nak_Moola": "மூலம்", "nak_Purva Ashadha": "பூராடம்", "nak_Uttara Ashadha": "உத்திராடம்",
                "nak_Shravana": "திருவோணம்", "nak_Dhanishta": "அவிட்டம்", "nak_Shatabhisha": "சதயம்",
                "nak_Purva Bhadrapada": "பூரட்டாதி", "nak_Uttara Bhadrapada": "உத்திரட்டாதி",
                "nak_Revati": "ரேவதி",

                // Sign Properties (Ruler, Element, Modality)
                "ruler_Sun": "சூரியன்", "ruler_Moon": "சந்திரன்", "ruler_Mars": "செவ்வாய்", "ruler_Mercury": "புதன்",
                "ruler_Jupiter": "குரு", "ruler_Venus": "சுக்கிரன்", "ruler_Saturn": "சனி",

                "element_Fire": "நெருப்பு", "element_Earth": "நிலம்", "element_Air": "காற்று", "element_Water": "நீர்",

                "modality_Cardinal": "சர", "modality_Fixed": "ஸ்திர", "modality_Dual": "உபய",

                // Sign Keywords (Tamil translations - IMPORTANT: VERIFY THESE FOR ACCURACY!)
                "keywords_Aries": "செயல், முன்னோடி, உறுதியான, தூண்டுதல், தலைமை, தைரியம்",
                "keywords_Taurus": "நிலைத்தன்மை, பாதுகாப்பு, விடாமுயற்சி, புலன்சார், அடிப்படையான, இன்பம் தேடும்",
                "keywords_Gemini": "தகவல் தொடர்பு, ஆர்வமுள்ள, பல்துறை, புத்திசாலி, சமூக, ஓய்வற்ற",
                "keywords_Cancer": "ஊக்குவிக்கும், உணர்ச்சிபூர்வமான, வீடு, உள்ளுணர்வு, பாதுகாக்கும், உணர்வுள்ள",
                "keywords_Leo": "படைப்பாற்றல், சுய வெளிப்பாடு, தன்னம்பிக்கை, தாராளமான, நாடகீய, விசுவாசமான",
                "keywords_Virgo": "பகுப்பாய்வு, சேவை, நடைமுறை, பரிபூரணவாதி, ஆரோக்கியம் சார்ந்த, விடாமுயற்சி",
                "keywords_Libra": "சமநிலை, நல்லிணக்கம், உறவுகள், நீதி, ராஜதந்திர, கலைநயமிக்க",
                "keywords_Scorpio": "மாற்றம், தீவிரம், ரகசியமான, சக்திவாய்ந்த, உணர்ச்சிபூர்வமான, விசாரணை",
                "keywords_Sagittarius": "விரிவாக்கம், ஞானம், சாகச, நம்பிக்கையான, தத்துவார்த்த, சுதந்திர மனப்பான்மை",
                "keywords_Capricorn": "ஒழுக்கம், லட்சியம், பொறுப்பு, கட்டமைக்கப்பட்ட, நடைமுறை, பொறுமையாளன்",
                "keywords_Aquarius": "புதுமை, மனிதாபிமானம், சுதந்திரமான, மேதகைமை, வழக்கத்திற்கு மாறான, தொலைநோக்கு",
                "keywords_Pisces": "ஆன்மீகம், கருணை, கலைத்திறன், பச்சாதாபம், கனவு காணும், உணர்வுள்ள"
            }
        };

        let currentLanguage = "en"; // Default language

        let draggedPlanetId = null;
        const planetDegrees = {}; // Stores { sign: "...", degree: #, isRetrograde: boolean }
        let initialPlanetBankHTML = '';
        let lagnaSign = null;

        let isChangingDegree = false;
        let degreeChangePlanet = null;
        let initialMouseY = 0;
        let initialPlanetDegree = 0;

        const planetTooltip = document.getElementById('planet-tooltip');
        const signHouseTooltip = document.getElementById('sign-house-tooltip');
        const retrogradePanel = document.getElementById('retrograde-panel');
        const retrogradeCheckbox = document.getElementById('retrograde-checkbox');
        const panelPlanetName = retrogradePanel.querySelector('.panel-planet-name');
        let selectedPlanetForRetrograde = null;

        document.addEventListener('DOMContentLoaded', () => {
            initialPlanetBankHTML = document.getElementById('planet-bank').innerHTML;
            attachDelegatedListeners();
            updateHouseNumbers();

            const languageSelect = document.getElementById('language-select');
            languageSelect.value = currentLanguage;
            languageSelect.addEventListener('change', (e) => setLanguage(e.target.value));
            setLanguage(currentLanguage); // Call initially to render default language

            document.getElementById('toggle-sign-labels-checkbox').addEventListener('change', toggleSignLabels);
            document.getElementById('toggle-house-numbers-checkbox').addEventListener('change', toggleHouseNumbers);
        });

        function attachDelegatedListeners() {
            document.addEventListener('dragstart', handleDragStart);
            document.addEventListener('dragend', handleDragEnd);
            document.addEventListener('mousedown', handleMouseDown);
            document.addEventListener('mouseup', handleMouseUp);
            document.addEventListener('dblclick', handleDblClick);
            document.addEventListener('mousemove', handleMouseMoveForTooltip);

            document.querySelectorAll('.planets-container').forEach(container => {
                container.addEventListener('dragover', allowDrop);
                container.addEventListener('drop', dropToChart);
                container.addEventListener('dragleave', removeDragOverHighlight);
                container.addEventListener('mouseover', handleContainerMouseOver);
                container.addEventListener('mouseout', handleContainerMouseOut);
                container.addEventListener('click', handlePlanetClick);
            });

            const planetBank = document.getElementById('planet-bank');
            planetBank.addEventListener('dragover', allowDrop);
            planetBank.addEventListener('drop', dropToBank);
            planetBank.addEventListener('dragleave', removeDragOverHighlight);

            retrogradeCheckbox.addEventListener('change', toggleRetrograde);

            document.addEventListener('click', handleOutsideClick);

            document.querySelectorAll('.sign-label').forEach(label => {
                label.addEventListener('mouseover', handleSignLabelMouseOver);
                label.addEventListener('mouseout', handleSignLabelMouseOut);
                label.addEventListener('mousemove', handleSignLabelMouseMove);
            });
        }

        // --- Drag & Drop Handlers ---

        function handleDragStart(e) {
            const planetElement = e.target.closest('.planet');
            if (planetElement) {
                draggedPlanetId = planetElement.id;
                e.dataTransfer.setData('text/plain', draggedPlanetId);
                planetElement.style.opacity = '0.5';
                hideTooltip();
                hideSignHouseTooltip();
                hideRetrogradePanel();
            }
        }

        function handleDragEnd(e) {
            const planetElement = e.target.closest('.planet');
            if (planetElement) {
                planetElement.style.opacity = '1';
                draggedPlanetId = null;
            }
        }

        function allowDrop(e) {
            e.preventDefault();
            let targetElement = e.target.classList.contains('planets-container') || e.target.id === 'planet-bank' ? e.target : e.target.closest('.planets-container') || e.target.closest('#planet-bank');
            if (targetElement) {
                targetElement.classList.add('drag-over');
            }
        }

        function removeDragOverHighlight(e) {
            let targetElement = e.target.classList.contains('planets-container') || e.target.id === 'planet-bank' ? e.target : e.target.closest('.planets-container') || e.target.closest('#planet-bank');
            if (targetElement) {
                targetElement.classList.remove('drag-over');
            }
        }

        function dropToChart(e) {
            e.preventDefault();
            let targetContainer = e.target.classList.contains('planets-container') ? e.target : e.target.closest('.planets-container');

            if (!targetContainer || !draggedPlanetId) return;

            targetContainer.classList.remove('drag-over');
            hideTooltip();
            hideSignHouseTooltip();
            hideRetrogradePanel();

            const planetToMove = document.getElementById(draggedPlanetId);
            if (!planetToMove) return;

            const currentParent = planetToMove.parentElement;

            if (currentParent === targetContainer) return;

            if (draggedPlanetId === 'Lagna') {
                const existingLagna = document.querySelector('.planets-container .Lagna');
                if (existingLagna) {
                    const oldLagnaParent = existingLagna.parentElement;
                    const planetBank = document.getElementById('planet-bank');

                    if (oldLagnaParent !== planetBank) {
                        oldLagnaParent.removeChild(existingLagna);
                        planetBank.appendChild(existingLagna);
                        delete planetDegrees[existingLagna.id];
                        updatePlanetDegreeDisplay(existingLagna);
                        updateRetrogradeSymbol(existingLagna);
                    }
                }
                lagnaSign = targetContainer.dataset.sign;
                updateHouseNumbers();
            }

            if (currentParent && (currentParent.classList.contains('planets-container') || currentParent.id === 'planet-bank')) {
                currentParent.removeChild(planetToMove);
            }

            targetContainer.appendChild(planetToMove);

            const sign = targetContainer.dataset.sign;
            if (!planetDegrees[planetToMove.id]) {
                planetDegrees[planetToMove.id] = {
                    sign: sign,
                    degree: parseFloat((Math.random() * 30).toFixed(2)),
                    isRetrograde: false
                };
            } else {
                planetDegrees[planetToMove.id].sign = sign;
            }
            updatePlanetDegreeDisplay(planetToMove);
            updateRetrogradeSymbol(planetToMove);
        }

        function dropToBank(e) {
            e.preventDefault();
            let targetBank = e.target.id === 'planet-bank' ? e.target : e.target.closest('#planet-bank');

            if (!targetBank || !draggedPlanetId) return;

            targetBank.classList.remove('drag-over');
            hideTooltip();
            hideSignHouseTooltip();
            hideRetrogradePanel();

            const planetToMove = document.getElementById(draggedPlanetId);
            if (!planetToMove) return;

            if (planetToMove.parentElement.id !== 'planet-bank') {
                const currentParent = planetToMove.parentElement;
                if (currentParent && currentParent.classList.contains('planets-container')) {
                    currentParent.removeChild(planetToMove);
                }
                targetBank.appendChild(planetToMove);

                if (planetToMove.id === 'Lagna') {
                    lagnaSign = null;
                    updateHouseNumbers();
                }

                delete planetDegrees[planetToMove.id];
                updatePlanetDegreeDisplay(planetToMove);
                updateRetrogradeSymbol(planetToMove);
            }
        }

        // --- Degree Change Handlers ---

        function handleMouseDown(e) {
            const planetElement = e.target.closest('.planet');
            if (!planetElement) return;

            if (planetElement.parentElement.classList.contains('planets-container')) {
                e.preventDefault();
                isChangingDegree = true;
                degreeChangePlanet = planetElement;
                initialMouseY = e.clientY;
                initialPlanetDegree = planetDegrees[planetElement.id]?.degree || 0;

                document.addEventListener('mousemove', handleDegreeChangeMouseMove);
                hideTooltip();
                hideSignHouseTooltip();
                hideRetrogradePanel();
            }
        }

        function handleDegreeChangeMouseMove(e) {
            if (!isChangingDegree || !degreeChangePlanet) return;

            const deltaY = initialMouseY - e.clientY;
            const degreeChange = deltaY / 20;
            let newDegree = initialPlanetDegree + degreeChange;

            newDegree = Math.max(0, Math.min(29.99, newDegree));

            if (planetDegrees[degreeChangePlanet.id]) {
                planetDegrees[degreeChangePlanet.id].degree = parseFloat(newDegree.toFixed(2));
                updatePlanetDegreeDisplay(degreeChangePlanet);
                showTooltip(degreeChangePlanet);
            }
        }

        function handleMouseUp() {
            if (isChangingDegree) {
                isChangingDegree = false;
                degreeChangePlanet = null;
                document.removeEventListener('mousemove', handleDegreeChangeMouseMove);
            }
        }

        function handleDblClick(e) {
            const planetToRemove = e.target.closest('.planet');
            if (!planetToRemove) return;

            const currentContainer = planetToRemove.parentElement;

            if (currentContainer && currentContainer.classList.contains('planets-container')) {
                currentContainer.removeChild(planetToRemove);
                document.getElementById('planet-bank').appendChild(planetToRemove);

                if (planetToRemove.id === 'Lagna') {
                    lagnaSign = null;
                    updateHouseNumbers();
                }

                delete planetDegrees[planetToRemove.id];
                updatePlanetDegreeDisplay(planetToRemove);
                updateRetrogradeSymbol(planetToRemove);
                hideTooltip();
                hideSignHouseTooltip();
                hideRetrogradePanel();
            }
        }

        // --- Planet Tooltip Functions ---

        function handleContainerMouseOver(e) {
            const planetElement = e.target.closest('.planet');
            if (planetElement && planetElement.parentElement.classList.contains('planets-container') && planetDegrees[planetElement.id]) {
                showTooltip(planetElement);
            }
        }

        function handleContainerMouseOut(e) {
            if (!isChangingDegree && !retrogradePanel.classList.contains('active')) {
                const relatedTarget = e.relatedTarget;
                if (!relatedTarget || (!relatedTarget.closest('.planet') && !relatedTarget.closest('#planet-tooltip') && !relatedTarget.closest('#retrograde-panel') && !relatedTarget.closest('#sign-house-tooltip'))) {
                    hideTooltip();
                }
            }
        }

        function handleMouseMoveForTooltip(e) {
            if (planetTooltip.classList.contains('active') && !isChangingDegree) {
                const targetPlanet = e.target.closest('.planet');
                if (targetPlanet && planetDegrees[targetPlanet.id] && e.target.closest('.planet') === document.querySelector('.planet.hovered-for-tooltip')) {
                     showTooltip(targetPlanet);
                } else {
                     hideTooltip();
                }
            }
        }

        function showTooltip(planetElement) {
            document.querySelectorAll('.planet.hovered-for-tooltip').forEach(el => el.classList.remove('hovered-for-tooltip'));
            planetElement.classList.add('hovered-for-tooltip');

            const t = translations[currentLanguage];

            const planetData = planetDegrees[planetElement.id];
            if (!planetData) {
                hideTooltip();
                return;
            }

            const nakData = getNakshatraAndPada(planetData.sign, planetData.degree);

            const translatedSign = t[`sign_${planetData.sign}`] || planetData.sign;
            const translatedNakshatra = t[`nak_${nakData.nakshatra.name}`] || nakData.nakshatra.name;

            let tooltipContent = `${planetData.degree.toFixed(2)}${t.tooltipDegreeSign} ${translatedSign} | ${translatedNakshatra} – Pada ${nakData.pada}`;
            if (planetData.isRetrograde) {
                tooltipContent += ` ${t.tooltipRetrograde}`;
            }
            planetTooltip.textContent = tooltipContent;

            const rect = planetElement.getBoundingClientRect();
            planetTooltip.style.left = `${rect.left + (rect.width / 2) - (planetTooltip.offsetWidth / 2)}px`;
            planetTooltip.style.top = `${rect.top - planetTooltip.offsetHeight - 5}px`;

            if (parseFloat(planetTooltip.style.left) < 0) {
                planetTooltip.style.left = '5px';
            }
            if (parseFloat(planetTooltip.style.left) + planetTooltip.offsetWidth > window.innerWidth) {
                planetTooltip.style.left = `${window.innerWidth - planetTooltip.offsetWidth - 5}px`;
            }
            if (parseFloat(planetTooltip.style.top) < 0) {
                planetTooltip.style.top = `${rect.bottom + 5}px`;
            }

            planetTooltip.classList.add('active');
        }

        function hideTooltip() {
            planetTooltip.classList.remove('active');
            document.querySelectorAll('.planet.hovered-for-tooltip').forEach(el => el.classList.remove('hovered-for-tooltip'));
        }

        // --- End Planet Tooltip Functions ---

        // --- Sign/House Tooltip Functions ---

        function handleSignLabelMouseOver(e) {
            const signLabel = e.target.closest('.sign-label');
            if (!signLabel) return;

            const chartBox = signLabel.closest('.chart-box');
            const signName = chartBox.dataset.sign; // English key for sign
            const houseNumberText = chartBox.querySelector('.house-label').textContent;
            let houseNumber = null;
            if (houseNumberText) {
                houseNumber = parseInt(houseNumberText);
            }

            const signInfo = signData[signName]; // Get English data structure
            // const houseInfo = houseNumber ? houseData[houseNumber] : null; // No longer needed for keywords, etc.

            const t = translations[currentLanguage]; // Get current translations

            let content = '';

            // House number and "House:" label
            if (houseNumber) {
                content += `<p><strong>${t.tooltipHouse}</strong> ${houseNumber}${getOrdinalSuffix(houseNumber)} House</p>`;
            } else {
                content += `<p><strong>${t.tooltipHouse}</strong> ${t.tooltipHouseNotAssigned}</p>`;
            }

            // House Keywords
            if (houseNumber && t[`keywords_house_${houseNumber}`]) {
                content += `<p class="tooltip-section-title">${t.tooltipHouseKeywords}</p><p>${t[`keywords_house_${houseNumber}`]}</p>`;
            }

            // Sign Keywords
            if (signName && t[`keywords_${signName}`]) {
                content += `<p class="tooltip-section-title">${t.tooltipSignKeywords}</p><p>${t[`keywords_${signName}`]}</p>`;
            }

            // Sign Properties
            if (signInfo) {
                const translatedRuler = t[`ruler_${signInfo.ruler}`] || signInfo.ruler;
                const translatedElement = t[`element_${signInfo.element}`] || signInfo.element;
                const translatedModality = t[`modality_${signInfo.modality}`] || signInfo.modality;

                content += `<p class="tooltip-section-title">${t.tooltipSignProperties}</p><p><strong>${t.tooltipRuler}</strong> ${translatedRuler} | <strong>${t.tooltipElement}</strong> ${translatedElement} | <strong>${t.tooltipModality}</strong> ${translatedModality}</p>`;
            }

            signHouseTooltip.innerHTML = content;
            signHouseTooltip.classList.add('active');

            positionSignHouseTooltip(e);
        }

        function handleSignLabelMouseOut(e) {
            const relatedTarget = e.relatedTarget;
            if (!relatedTarget || (!relatedTarget.closest('#sign-house-tooltip') && !relatedTarget.closest('.sign-label'))) {
                hideSignHouseTooltip();
            }
        }

        function handleSignLabelMouseMove(e) {
            positionSignHouseTooltip(e);
        }

        function positionSignHouseTooltip(e) {
            const targetRect = e.target.getBoundingClientRect();
            let top = targetRect.bottom + 5;
            let left = targetRect.left;

            if (left + signHouseTooltip.offsetWidth > window.innerWidth) {
                left = window.innerWidth - signHouseTooltip.offsetWidth - 10;
            }
            if (left < 0) {
                left = 10;
            }
            if (top + signHouseTooltip.offsetHeight > window.innerHeight) {
                top = targetRect.top - signHouseTooltip.offsetHeight - 5;
                if (top < 0) {
                    top = 5;
                }
            }

            signHouseTooltip.style.left = `${left}px`;
            signHouseTooltip.style.top = `${top}px`;
        }

        function hideSignHouseTooltip() {
            signHouseTooltip.classList.remove('active');
            signHouseTooltip.innerHTML = '';
        }

        function getOrdinalSuffix(n) {
            const s = ["th", "st", "nd", "rd"];
            const v = n % 100;
            return s[(v - 20) % 10] || s[v] || s[0];
        }

        // --- End Sign/House Tooltip Functions ---

        // --- Retrograde Panel Functions ---

        function handlePlanetClick(e) {
            const clickedPlanet = e.target.closest('.planet');
            if (clickedPlanet && clickedPlanet.parentElement.classList.contains('planets-container') && planetDegrees[clickedPlanet.id]) {
                e.stopPropagation();

                if (selectedPlanetForRetrograde === clickedPlanet && retrogradePanel.classList.contains('active')) {
                    hideRetrogradePanel();
                    return;
                }

                selectedPlanetForRetrograde = clickedPlanet;
                const planetData = planetDegrees[clickedPlanet.id];

                const t = translations[currentLanguage];
                panelPlanetName.textContent = `${t.planetColon} ${clickedPlanet.id}`; // Use ID as planet name for now
                retrogradeCheckbox.checked = planetData.isRetrograde;
                retrogradeCheckbox.nextSibling.textContent = ` ${t.retrogradeCheckbox}`; // Update checkbox label

                const rect = clickedPlanet.getBoundingClientRect();
                retrogradePanel.style.left = `${rect.right + 10}px`;
                retrogradePanel.style.top = `${rect.top}px`;

                if (parseFloat(retrogradePanel.style.left) + retrogradePanel.offsetWidth > window.innerWidth) {
                    retrogradePanel.style.left = `${rect.left - retrogradePanel.offsetWidth - 10}px`;
                }
                if (parseFloat(retrogradePanel.style.top) < 0) {
                    retrogradePanel.style.top = `5px`;
                }
                if (parseFloat(retrogradePanel.style.top) + retrogradePanel.offsetHeight > window.innerHeight) {
                    retrogradePanel.style.top = `${window.innerHeight - retrogradePanel.offsetHeight - 5}px`;
                }

                retrogradePanel.classList.add('active');
            } else {
                if (!retrogradePanel.contains(e.target)) {
                    hideRetrogradePanel();
                }
            }
        }

        function toggleRetrograde() {
            if (selectedPlanetForRetrograde && planetDegrees[selectedPlanetForRetrograde.id]) {
                const isChecked = retrogradeCheckbox.checked;
                planetDegrees[selectedPlanetForRetrograde.id].isRetrograde = isChecked;
                updateRetrogradeSymbol(selectedPlanetForRetrograde);
                if (planetTooltip.classList.contains('active') && document.querySelector('.planet.hovered-for-tooltip') === selectedPlanetForRetrograde) {
                    showTooltip(selectedPlanetForRetrograde);
                }
            }
        }

        function updateRetrogradeSymbol(planetElement) {
            let symbolSpan = planetElement.querySelector('.retrograde-symbol');
            if (!symbolSpan) {
                symbolSpan = document.createElement('span');
                symbolSpan.classList.add('retrograde-symbol');
                const planetSymbolSpan = planetElement.querySelector('.planet-symbol');
                if (planetSymbolSpan) {
                    planetSymbolSpan.insertAdjacentElement('afterend', symbolSpan);
                } else {
                    planetElement.appendChild(symbolSpan);
                }
            }

            const planetData = planetDegrees[planetElement.id];
            if (planetData && planetData.isRetrograde) {
                symbolSpan.textContent = ' R';
                planetElement.classList.add('retrograde');
            } else {
                symbolSpan.textContent = '';
                planetElement.classList.remove('retrograde');
            }
        }

        function hideRetrogradePanel() {
            retrogradePanel.classList.remove('active');
            selectedPlanetForRetrograde = null;
        }

        function handleOutsideClick(e) {
            if (retrogradePanel.classList.contains('active') &&
                !retrogradePanel.contains(e.target) &&
                !e.target.closest('.planet')) {
                hideRetrogradePanel();
            }
            if (signHouseTooltip.classList.contains('active') &&
                !signHouseTooltip.contains(e.target) &&
                !e.target.closest('.sign-label')) {
                hideSignHouseTooltip();
            }
        }

        // --- End Retrograde Panel Functions ---

        // --- General Chart Functions ---

        function setLanguage(lang) {
            currentLanguage = lang;
            const t = translations[currentLanguage];

            document.querySelector('.chart-title').textContent = t.chartTitle;
            document.querySelector('.controls > div > span').textContent = t.dragTip;
            document.querySelector('button[onclick="resetChart()"]').textContent = t.clearChart;
            document.querySelector('.controls > p').textContent = t.degreeTip;
            document.querySelector('#toggle-sign-labels-checkbox').nextSibling.textContent = t.hideSignLabelsOption;
            document.querySelector('#toggle-house-numbers-checkbox').nextSibling.textContent = t.hideHouseNumbersOption;


            document.getElementById('Lagna').querySelector('.planet-symbol').textContent = t.lagnaSymbol;
            document.getElementById('Sun').querySelector('.planet-symbol').textContent = t.sunSymbol;
            document.getElementById('Moon').querySelector('.planet-symbol').textContent = t.moonSymbol;
            document.getElementById('Mars').querySelector('.planet-symbol').textContent = t.marsSymbol;
            document.getElementById('Mercury').querySelector('.planet-symbol').textContent = t.mercurySymbol;
            document.getElementById('Jupiter').querySelector('.planet-symbol').textContent = t.jupiterSymbol;
            document.getElementById('Venus').querySelector('.planet-symbol').textContent = t.venusSymbol;
            document.getElementById('Saturn').querySelector('.planet-symbol').textContent = t.saturnSymbol;
            document.getElementById('Rahu').querySelector('.planet-symbol').textContent = t.rahuSymbol;
            document.getElementById('Ketu').querySelector('.planet-symbol').textContent = t.ketuSymbol;

            document.getElementById('retrograde-checkbox').nextSibling.textContent = ` ${t.retrogradeCheckbox}`;

            document.querySelectorAll('.chart-box').forEach(box => {
                const signName = box.dataset.sign;
                if (signName) {
                    // Use translated sign name, taking first two characters
                    box.querySelector('.sign-label').textContent = (t[`sign_${signName}`] || signName).substring(0, 2);
                }
            });

            if (planetTooltip.classList.contains('active')) {
                const activePlanet = document.querySelector('.planet.hovered-for-tooltip');
                if (activePlanet) showTooltip(activePlanet);
            }
            if (signHouseTooltip.classList.contains('active')) {
                // If the sign/house tooltip is active, we need to re-render it
                // We can't simply call handleSignLabelMouseOver directly as it needs an event object.
                // A simpler way is to just hide it and let the user re-hover.
                hideSignHouseTooltip();
            }

            if (retrogradePanel.classList.contains('active') && selectedPlanetForRetrograde) {
                panelPlanetName.textContent = `${t.planetColon} ${selectedPlanetForRetroade.id}`;
            }
        }

        function getNakshatraAndPada(sign, degree) {
            const nakshatraLengthDegrees = 13.333333333;
            const padaLengthDegrees = nakshatraLengthDegrees / 4;

            const signIndex = signs.indexOf(sign);
            if (signIndex === -1) {
                return { nakshatra: { name: 'N/A' }, pada: '-' };
            }

            const totalDegrees = (signIndex * 30) + degree;

            let nakshatraNumber = Math.floor(totalDegrees / nakshatraLengthDegrees);

            if (nakshatraNumber >= nakshatras.length) {
                nakshatraNumber = nakshatras.length - 1;
            }

            const foundNakshatra = nakshatras[nakshatraNumber];
            const degreesIntoCurrentNakshatra = totalDegrees % nakshatraLengthDegrees;
            const pada = Math.floor(degreesIntoCurrentNakshatra / padaLengthDegrees) + 1;

            return {
                nakshatra: foundNakshatra,
                pada: pada
            };
        }

        function updatePlanetDegreeDisplay(planetElement) {
            let degreeDisplay = planetElement.querySelector('.planet-degree-display');
            if (!degreeDisplay) {
                degreeDisplay = document.createElement('span');
                degreeDisplay.classList.add('planet-degree-display');
                planetElement.appendChild(degreeDisplay);
            }

            const planetData = planetDegrees[planetElement.id];

            if (planetData) {
                degreeDisplay.textContent = `${planetData.degree.toFixed(2)}°`;
            } else {
                degreeDisplay.textContent = '';
            }
        }

        function resetChart() {
            document.querySelectorAll('.planets-container').forEach(container => {
                Array.from(container.children).forEach(planetEl => {
                    delete planetDegrees[planetEl.id];
                    updatePlanetDegreeDisplay(planetEl);
                    updateRetrogradeSymbol(planetEl);
                });
                container.innerHTML = '';
            });
            document.getElementById('planet-bank').innerHTML = initialPlanetBankHTML;

            // Re-apply correct planet symbols after reset due to language
            const t = translations[currentLanguage];
            document.getElementById('Lagna').querySelector('.planet-symbol').textContent = t.lagnaSymbol;
            document.getElementById('Sun').querySelector('.planet-symbol').textContent = t.sunSymbol;
            document.getElementById('Moon').querySelector('.planet-symbol').textContent = t.moonSymbol;
            document.getElementById('Mars').querySelector('.planet-symbol').textContent = t.marsSymbol;
            document.getElementById('Mercury').querySelector('.planet-symbol').textContent = t.mercurySymbol;
            document.getElementById('Jupiter').querySelector('.planet-symbol').textContent = t.jupiterSymbol;
            document.getElementById('Venus').querySelector('.planet-symbol').textContent = t.venusSymbol;
            document.getElementById('Saturn').querySelector('.planet-symbol').textContent = t.saturnSymbol;
            document.getElementById('Rahu').querySelector('.planet-symbol').textContent = t.rahuSymbol;
            document.getElementById('Ketu').querySelector('.planet-symbol').textContent = t.ketuSymbol;

            lagnaSign = null;
            resetAllPlanetDegrees();
            hideTooltip();
            hideSignHouseTooltip();
            hideRetrogradePanel();
            updateHouseNumbers();

            // Uncheck both checkboxes on reset
            document.getElementById('toggle-sign-labels-checkbox').checked = false;
            document.getElementById('toggle-house-numbers-checkbox').checked = false;
            toggleSignLabels(); // Ensure labels are visible on reset
            toggleHouseNumbers(); // Ensure numbers are visible on reset
        }

        function resetAllPlanetDegrees() {
            for (const planetId in planetDegrees) {
                delete planetDegrees[planetId];
            }
            document.querySelectorAll('#planet-bank .planet').forEach(planetEl => {
                updatePlanetDegreeDisplay(planetEl);
                updateRetrogradeSymbol(planetEl);
            });
        }

        const chartBoxes = document.querySelectorAll('.chart-box[data-sign]');
        function updateHouseNumbers() {
            chartBoxes.forEach(box => {
                const houseLabel = box.querySelector('.house-label');
                if (lagnaSign) {
                    const ascendantIndexInSigns = signs.indexOf(lagnaSign);
                    const signInBox = box.dataset.sign;
                    const signIndexInSigns = signs.indexOf(signInBox);

                    let houseNumber = (signIndexInSigns - ascendantIndexInSigns + 12) % 12 + 1;
                    box.dataset.house = houseNumber; // Store house number on box
                    houseLabel.textContent = `${houseNumber}`;
                } else {
                    box.dataset.house = ''; // Clear house number
                    houseLabel.textContent = '';
                }
            });
            hideSignHouseTooltip();
        }

        // NEW: Function to toggle visibility of sign labels
        function toggleSignLabels() {
            const chartContainer = document.getElementById('chart-container');
            const toggleSignLabelsCheckbox = document.getElementById('toggle-sign-labels-checkbox');
            if (toggleSignLabelsCheckbox.checked) {
                chartContainer.classList.add('hide-sign-labels');
                hideSignHouseTooltip(); // Hide tooltip if labels are hidden
            } else {
                chartContainer.classList.remove('hide-sign-labels');
            }
        }

        // NEW: Function to toggle visibility of house numbers
        function toggleHouseNumbers() {
            const chartContainer = document.getElementById('chart-container');
            const toggleHouseNumbersCheckbox = document.getElementById('toggle-house-numbers-checkbox');
            if (toggleHouseNumbersCheckbox.checked) {
                chartContainer.classList.add('hide-house-numbers');
                hideSignHouseTooltip(); // Hide tooltip if numbers are hidden
            } else {
                chartContainer.classList.remove('hide-house-numbers');
            }
        }
    </script>
</body>
</html>